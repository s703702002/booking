(this.webpackJsonpbooking=this.webpackJsonpbooking||[]).push([[0],{12:function(e,t,n){e.exports=n.p+"static/media/desc.f06acfc6.svg"},13:function(e,t,n){e.exports=n.p+"static/media/asc.d8be3f88.svg"},14:function(e,t,n){e.exports=n.p+"static/media/exchange.c7b5a736.svg"},18:function(e,t,n){e.exports=n(30)},23:function(e,t,n){},24:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(9),l=n.n(o),c=(n(23),n(24),n(2)),i=n(1),s=n(3);function u(){const e=Object(c.a)(["\n  position: fixed;\n  bottom: 5%;\n  right: 5%;\n  z-index: 1050;\n  width: 45px;\n  height: 45px;\n  background: #eee;\n  border-radius: 50%;\n  text-align: center;\n  padding: 0;\n  display: none;\n"]);return u=function(){return e},e}function m(){window.scrollTo({top:0,left:0,behavior:"smooth"})}var d=Object(s.a)((function(e){let t=Object.assign({},e);const n=function(){const e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)(()=>{function e(){window.scrollY>200?r(!0):r(!1)}return e(),window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[r]),n}();return r.a.createElement("button",Object.assign({style:n?{display:"block"}:null,onClick:m},t),"TOP")}))(u());const p="https://ptx.transportdata.tw/MOTC",b={method:"GET",mode:"cors",headers:{"Content-Type":"application/json","Accept-Encoding":"gzip, deflate"}};function E(e){const t=e.split(":");return 60*parseInt(t[0],10)+parseInt(t[1],10)}function f(e){return e.length<2?"0"+e:e}var v=n(12),g=n.n(v),h=n(13),O=n.n(h);n(14);function j(){const e=Object(c.a)(["\n  width: 20px;\n"]);return j=function(){return e},e}function T(){const e=Object(c.a)(["\n  width: 20px;\n"]);return T=function(){return e},e}const w=Object(s.a)(e=>{let t=Object.assign({},e);return r.a.createElement("img",Object.assign({},t,{src:g.a,alt:"desc"}))})(T()),S=Object(s.a)(e=>{let t=Object.assign({},e);return r.a.createElement("img",Object.assign({},t,{src:O.a,alt:"asc"}))})(j());function k(){const e=Object(c.a)(["\n  padding: 0.3em;\n  vertical-align: middle;\n  font-weight: bold;\n  cursor: ",";\n"]);return k=function(){return e},e}function D(){const e=Object(c.a)(["\n  width: 100%;\n  box-shadow: 0px 3px 10px #ddd;\n  thead {\n    background-color: #eee;\n  }\n  td {\n    padding: 0.3em;\n    vertical-align: middle;\n  }\n  tr:nth-child(even) {\n    background-color: #eee;\n  }\n"]);return D=function(){return e},e}const x=s.a.table(D()),y=s.a.th(k(),e=>e.pointer?"pointer":"initial"),N=r.a.memo(({TrainNo:e,DepartureTime:t,ArrivalTime:n})=>{const a=E(t),o=E(n);return r.a.createElement("tr",null,r.a.createElement("td",{className:"text-info font-weight-bold"},e),r.a.createElement("td",null,t),r.a.createElement("td",null,n),r.a.createElement("td",null,function(e){let t=0;for(;e>=60;)e-=60,t+=1;return t=f(t.toString()),t+":"+(e=f(e.toString()))}(o-a)))}),C=()=>r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"4"},"\u5c1a\u7121\u8cc7\u6599"));var A=r.a.memo(({sortByDeparture:e,sortByArrival:t,resultList:n,onClickDepartureSort:a,onClickArrivalSort:o})=>r.a.createElement(x,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement(y,null,"\u8eca\u6b21"),r.a.createElement(y,{pointer:!0,onClick:a},"\u767c\u8eca","desc"===e?r.a.createElement(w,null):r.a.createElement(S,null)),r.a.createElement(y,{pointer:!0,onClick:o},"\u5230\u9054","desc"===t?r.a.createElement(w,null):r.a.createElement(S,null)),r.a.createElement(y,null,"\u7e3d\u6642\u7a0b"))),r.a.createElement("tbody",null,n.length>0?n.map(e=>r.a.createElement(N,{key:e.DailyTrainInfo.TrainNo,TrainNo:e.DailyTrainInfo.TrainNo,DepartureTime:e.OriginStopTime.DepartureTime,ArrivalTime:e.DestinationStopTime.ArrivalTime})):r.a.createElement(C,null))));function R(){const e=Object(c.a)(["\n  width: 100%;\n  background-color: #aeeff9;\n  th,\n  td {\n    padding: 0.3em;\n  }\n"]);return R=function(){return e},e}const F=s.a.table(R());var L=({prizeList:e,departure:t,arrival:n})=>r.a.createElement("div",{className:"mt-3 mb-3"},r.a.createElement("h3",null,"\u7968\u50f9\u8cc7\u8a0a"),r.a.createElement(F,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{colSpan:"3"},t,r.a.createElement("span",{className:"ml-2 mr-2"},"\u2192"),n))),r.a.createElement("tbody",null,r.a.createElement("tr",null,e.map(e=>r.a.createElement("td",{key:e.Price},e.TicketType,":",r.a.createElement("strong",null,"$",e.Price))))))),W=n(17);function B({children:e}){return r.a.createElement("div",{className:"row form-group"},e)}function I({htmlFor:e,children:t}){return r.a.createElement("label",{htmlFor:e,className:"col-4 col-form-label text-left"},t)}const P=r.a.memo(({children:e})=>r.a.createElement("div",{className:"col"},e));var z=n(7);const H=r.a.memo(r.a.forwardRef((e,t)=>{let n=e.options,a=Object(z.a)(e,["options"]);return r.a.createElement("select",Object.assign({},a,{ref:t}),n.length>0?n.map(e=>r.a.createElement("option",{key:e.value,value:e.value},e.Zh_tw+e.En)):r.a.createElement("option",{value:""},"\u8acb\u9078\u64c7"))})),U=e=>{e.options;let t=Object(z.a)(e,["options"]);return r.a.createElement("select",t,r.a.createElement("option",{value:"06:00"},"06:00"),r.a.createElement("option",{value:"07:00"},"07:00"),r.a.createElement("option",{value:"08:00"},"08:00"),r.a.createElement("option",{value:"09:00"},"09:00"),r.a.createElement("option",{value:"10:00"},"10:00"),r.a.createElement("option",{value:"11:00"},"11:00"),r.a.createElement("option",{value:"12:00"},"12:00"),r.a.createElement("option",{value:"13:00"},"13:00"),r.a.createElement("option",{value:"14:00"},"14:00"),r.a.createElement("option",{value:"15:00"},"15:00"),r.a.createElement("option",{value:"16:00"},"16:00"),r.a.createElement("option",{value:"17:00"},"17:00"),r.a.createElement("option",{value:"18:00"},"18:00"),r.a.createElement("option",{value:"19:00"},"19:00"),r.a.createElement("option",{value:"20:00"},"20:00"),r.a.createElement("option",{value:"21:00"},"21:00"),r.a.createElement("option",{value:"22:00"},"22:00"),r.a.createElement("option",{value:"23:00"},"23:00"),r.a.createElement("option",{value:"24:00"},"24:00"))};var J=H;function M(){const e=Object(c.a)(["\n  box-shadow: 1px 1px 5px #ddd;\n  background-color: #f3f3f3;\n  border-color: #ddd;\n  color: #333;\n  text-shadow: 0 1px 0 #eee;\n  padding-top: 0.5em;\n  padding-bottom: 0.5em;\n  margin-bottom: 0.5em;\n  .col-form-label {\n    max-width: 7em;\n  }\n"]);return M=function(){return e},e}const Y=function(){let e=(new Date).getHours()+1,t=e+3;return e=f(e.toString())+":00",t=f(t.toString())+":00",{defaultDepTime:e,defaultArrTime:t}}(),$=Y.defaultDepTime,G=Y.defaultArrTime;var Z=Object(s.a)(({onSearch:e,departureRef:t,arrivalRef:n,className:o})=>{const l=Object(a.useState)([]),c=Object(i.a)(l,2),s=c[0],u=c[1],m=Object(a.useState)(function(e){let t=new Date(e),n=""+(t.getMonth()+1),a=""+t.getDate(),r=t.getFullYear();return n.length<2&&(n="0"+n),a.length<2&&(a="0"+a),[r,n,a].join("-")}(Date.now())),d=Object(i.a)(m,2),E=d[0],f=d[1],v=Object(a.useState)("1000"),g=Object(i.a)(v,2),h=g[0],O=g[1],j=Object(a.useState)("1070"),T=Object(i.a)(j,2),w=T[0],S=T[1],k=Object(a.useState)($),D=Object(i.a)(k,2),x=D[0],y=D[1],N=Object(a.useState)(G),C=Object(i.a)(N,2),A=C[0],R=C[1];var F;return F=()=>{fetch(p+"/v2/Rail/THSR/Station",b).then(e=>e.json()).then(e=>{const t=e.map(e=>Object(W.a)({value:e.StationID},e.StationName));u(t)}).catch(e=>console.log(e))},Object(a.useEffect)(F,[]),r.a.createElement("div",{className:"container ".concat(o)},r.a.createElement(B,null,r.a.createElement(I,{htmlFor:"trip-start"},"\u65e5\u671f"),r.a.createElement(P,null,r.a.createElement("input",{className:"form-control",type:"date",id:"trip-start",value:E,onChange:e=>f(e.currentTarget.value)}))),r.a.createElement(B,null,r.a.createElement(I,{htmlFor:"OrginStation"},"\u8d77\u7ad9"),r.a.createElement(P,null,r.a.createElement(J,{className:"form-control",name:"OrginStation",id:"OrginStation",options:s,value:h,onChange:e=>O(e.currentTarget.value),ref:t}))),r.a.createElement("div",{className:"row justify-content-center form-group"},r.a.createElement("button",{onClick:()=>{O(w),S(h)},type:"button",className:"btn btn-outline-primary"},"\u8d77\u8fc4\u7ad9\u4ea4\u63db")),r.a.createElement(B,null,r.a.createElement(I,{htmlFor:"DestinationStation"},"\u8fc4\u7ad9"),r.a.createElement(P,null,r.a.createElement(J,{className:"form-control",name:"DestinationStation",id:"DestinationStation",options:s,value:w,onChange:e=>S(e.currentTarget.value),ref:n}))),r.a.createElement(B,null,r.a.createElement(I,{htmlFor:"DepartureTime"},"\u6700\u65e9\u51fa\u767c"),r.a.createElement(P,null,r.a.createElement(U,{className:"form-control",name:"DepartureTime",id:"DepartureTime",value:x,onChange:e=>y(e.target.value)}))),r.a.createElement(B,null,r.a.createElement(I,{htmlFor:"ArriveTime"},"\u6700\u665a\u62b5\u9054"),r.a.createElement(P,null,r.a.createElement(U,{className:"form-control",name:"ArriveTime",id:"ArriveTime",value:A,onChange:e=>R(e.target.value)}))),r.a.createElement("button",{type:"button",className:"btn btn-primary btn-lg btn-block",onClick:()=>e({date:E,departure:h,arrival:w,departureTime:x,arriveTime:A})},"\u67e5\u8a62"))})(M());var _=()=>{const e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],o=t[1],l=Object(a.useRef)(),c=Object(a.useRef)(),s=Object(a.useState)("desc"),u=Object(i.a)(s,2),m=u[0],d=u[1],f=Object(a.useState)("desc"),v=Object(i.a)(f,2),g=v[0],h=v[1],O=Object(a.useState)([]),j=Object(i.a)(O,2),T=j[0],w=j[1],S=Object(a.useState)([]),k=Object(i.a)(S,2),D=k[0],x=k[1],y=Object(a.useCallback)(({date:e,departure:t,arrival:n,departureTime:a,arriveTime:r})=>{(function(e,t,n){const a="/v2/Rail/THSR/DailyTimetable/OD/".concat(e,"/to/").concat(t,"/").concat(n);return fetch(p+a,b)})(t,n,e).then(e=>e.json()).then(e=>{const t=E(a),n=E(r),l=e.filter(e=>{const a=E(e.OriginStopTime.DepartureTime),r=E(e.DestinationStopTime.ArrivalTime);return a>t&&r<n});w(l),o(e[0].UpdateTime)}).catch(e=>console.log(e)),function(e,t){const n="/v2/Rail/THSR/ODFare/".concat(e,"/to/").concat(t);return fetch(p+n,b)}(t,n).then(e=>e.json()).then(e=>x(e[0].Fares)).catch(e=>console.log(e))},[]),N=Object(a.useCallback)(()=>{d("desc"===m?"asc":"desc"),w(T.sort((e,t)=>{const n=E(e.OriginStopTime.DepartureTime),a=E(t.OriginStopTime.DepartureTime);return"desc"===m?n-a:a-n}))},[m,T]),C=Object(a.useCallback)(()=>{h("desc"===g?"asc":"desc"),w(T.sort((e,t)=>{const n=E(e.DestinationStopTime.ArrivalTime),a=E(t.DestinationStopTime.ArrivalTime);return"desc"===g?n-a:a-n}))},[g,T]);return r.a.createElement("div",null,r.a.createElement("header",null,r.a.createElement("h1",null,"\u9ad8\u9435\u6642\u523b\u67e5\u8a62")),r.a.createElement(Z,{onSearch:y,departureRef:l,arrivalRef:c}),r.a.createElement("div",{className:"container"},r.a.createElement(A,{sortByDeparture:m,sortByArrival:g,resultList:T,onClickDepartureSort:N,onClickArrivalSort:C}),D.length>0?r.a.createElement(L,{prizeList:D,departure:l.current.selectedOptions[0].textContent,arrival:c.current.selectedOptions[0].textContent}):null),r.a.createElement("footer",{className:"fixed-bottom"},r.a.createElement("p",null,"\u66f4\u65b0\u6642\u9593: ",n)))};var q=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(d,null),r.a.createElement(_,null))};const K=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Q(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const n=e.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}l.a.render(r.a.createElement(q,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/booking",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="".concat("/booking","/service-worker.js");K?(!function(e,t){fetch(e).then(n=>{const a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):Q(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Q(t,e)})}}()}},[[18,1,2]]]);
//# sourceMappingURL=main.8219f941.chunk.js.map